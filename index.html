<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Valentine Envelope</title>
  <style>
    :root {
      --pink-1: #f8e6ee;
      --pink-2: #edd2de;
      --ink: #4e1f33;
      --accent: #d1457f;
      --wax: #c93268;
      --paper: #fff9ed;
      --paper-shadow: #e8d8c4;
      --vintage-line: rgba(109, 67, 44, 0.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 24px;
      font-family: Georgia, "Times New Roman", serif;
      color: var(--ink);
      background: radial-gradient(circle at top, var(--pink-1), var(--pink-2));
    }

    .scene {
      position: relative;
      width: min(760px, 96vw);
      min-height: 620px;
      display: grid;
      place-items: center;
    }

    .hint {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 248, 252, 0.86);
      border: 1px solid #e7b1c8;
      border-radius: 999px;
      padding: 8px 15px;
      font: 700 0.9rem/1.2 "Segoe UI", Tahoma, sans-serif;
      color: var(--accent);
      z-index: 10;
    }

    .hearts {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .heart {
      position: absolute;
      bottom: -36px;
      color: #f03a77;
      opacity: 0;
      animation: floatUp 4.2s ease-in infinite;
      font-size: 22px;
    }

    .heart:nth-child(1) { left: 12%; animation-delay: 0s; }
    .heart:nth-child(2) { left: 24%; animation-delay: .7s; }
    .heart:nth-child(3) { left: 40%; animation-delay: 1.4s; }
    .heart:nth-child(4) { left: 55%; animation-delay: .4s; }
    .heart:nth-child(5) { left: 70%; animation-delay: 1.8s; }
    .heart:nth-child(6) { left: 86%; animation-delay: 2.2s; }

    @keyframes floatUp {
      0% { transform: translateY(0) scale(.72); opacity: 0; }
      10% { opacity: .9; }
      100% { transform: translateY(-110vh) scale(1.14); opacity: 0; }
    }

    .stage {
      position: relative;
      width: 390px;
      height: 360px;
      display: grid;
      place-items: end center;
      z-index: 2;
    }

    .envelope-wrap {
      position: relative;
      width: 330px;
      height: 230px;
      z-index: 3;
      cursor: pointer;
    }

    .envelope {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 195px;
      background: #f8b9cf;
      border: 2px solid #e690b4;
      border-radius: 8px;
      box-shadow: 0 16px 35px rgba(201, 59, 112, 0.22);
      overflow: hidden;
    }

    .envelope::before,
    .envelope::after {
      content: "";
      position: absolute;
      top: 0;
      width: 50%;
      height: 100%;
      background: rgba(255, 255, 255, 0.24);
      clip-path: polygon(0 0, 100% 50%, 0 100%);
    }

    .envelope::after { right: 0; transform: scaleX(-1); }

    .flap {
      position: absolute;
      inset: 0;
      transform-origin: top;
      transition: transform 760ms cubic-bezier(.2,.76,.27,1.03);
      z-index: 4;
      pointer-events: none;
    }

    .flap::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      length: 1000%
      height: 90px;
      background: #f29abf;
      clip-path: polygon(50% 100%, 0 0, 100% 0);
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
      border: 2px solid #e690b4;
      border-bottom: none;
    }

    .seal {
      position: absolute;
      left: 50%;
      top: 75px;
      transform: translate(-50%, -50%);
      width: 58px;
      height: 58px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ff9ec2, var(--wax));
      border: 2px solid #ffd2e2;
      box-shadow: 0 8px 16px rgba(141, 21, 66, 0.32);
      color: #ffe8f1;
      display: grid;
      place-items: center;
      font-size: 1.15rem;
      z-index: 5;
    }

    .seal::before,
    .seal::after {
      content: "";
      position: absolute;
      width: 2px;
      height: 34px;
      background: rgba(255, 235, 242, 0.92);
      opacity: 0;
      transform-origin: center;
      border-radius: 3px;
    }

    .seal::before { transform: rotate(26deg) scaleY(0.2); }
    .seal::after { transform: rotate(-22deg) scaleY(0.2); }

    @keyframes crackSeal {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      25% { transform: translate(-50%, -50%) scale(1.07) rotate(-2deg); }
      55% { transform: translate(-50%, -50%) scale(0.95) rotate(4deg); opacity: 1; }
      100% { transform: translate(-50%, -50%) translateY(12px) scale(0.3) rotate(18deg); opacity: 0; }
    }

    .letter {
      position: absolute;
      left: 50%;
      bottom: 34px;
      transform: translate(-50%, 95px) rotateX(82deg) scale(0.88);
      transform-origin: bottom center;
      opacity: 0;
      width: 285px;
      padding: 20px 18px;
      border-radius: 8px;
      border: 1px solid #dfc8b4;
      color: #5a3b2f;
      background:
        repeating-linear-gradient(180deg, transparent 0 26px, var(--vintage-line) 26px 27px),
        linear-gradient(145deg, #fffdf7, var(--paper));
      box-shadow: 0 12px 24px rgba(111, 77, 44, 0.2), inset 0 0 1px #fff;
      z-index: 2;
      transition: transform 850ms cubic-bezier(.2,.8,.2,1), opacity 420ms ease;
    }

    .letter h2 {
      margin: 0 0 8px;
      color: #8b3a62;
      font-size: 2rem;
      font-family: "Brush Script MT", "Lucida Handwriting", cursive;
      font-weight: 500;
    }

    .letter p {
      margin: 0 0 10px;
      font-size: 1.03rem;
      line-height: 1.55;
      font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
    }

    .card {
      position: absolute;
      top: 6px;
      left: 50%;
      width: 340px;
      min-height: 270px;
      transform: translateX(-50%) perspective(1200px) rotateY(-92deg);
      transform-origin: left center;
      opacity: 0;
      pointer-events: none;
      border-radius: 14px;
      border: 1px solid #dbbecf;
      background: linear-gradient(160deg, #fffbf7, #fff3f9);
      box-shadow: 0 18px 35px rgba(116, 69, 92, 0.23);
      padding: 18px;
      z-index: 6;
      transition: transform 850ms ease, opacity 320ms ease;
    }

    .card h3 {
      margin: 0;
      font-size: 1.8rem;
      color: #c8447b;
      font-family: "Brush Script MT", "Lucida Handwriting", cursive;
      font-weight: 500;
    }

    .typed {
      min-height: 104px;
      margin-top: 8px;
      line-height: 1.65;
      font-size: 1.04rem;
      font-family: "Brush Script MT", "Segoe Script", cursive;
      letter-spacing: 0.2px;
    }

    .typed.writing {
      text-shadow: 0 0 1px rgba(51, 26, 39, 0.35);
    }

    .signature {
      margin-top: 10px;
      font-size: 2rem;
      color: transparent;
      background: linear-gradient(90deg, #ad2f64, #d34f84 45%, #ad2f64 85%);
      background-size: 220% 100%;
      background-position: 130% 0;
      -webkit-background-clip: text;
      background-clip: text;
      opacity: 0;
      transition: opacity 280ms ease;
      font-family: "Brush Script MT", "Lucida Handwriting", cursive;
      font-weight: 500;
    }

    .card-actions { margin-top: 6px; text-align: right; }

    button {
      border: 0;
      border-radius: 10px;
      padding: 8px 15px;
      background: var(--accent);
      color: white;
      font: 700 1.05rem/1 "Segoe UI", sans-serif;
      cursor: pointer;
    }

    @keyframes inkFlow {
      from { background-position: 130% 0; }
      to { background-position: 0 0; }
    }

    .scene.crack .seal {
      animation: crackSeal 540ms ease forwards;
    }

    .scene.crack .seal::before,
    .scene.crack .seal::after {
      opacity: 1;
      transition: opacity 120ms ease;
    }

    .scene.open .flap { transform: rotateX(180deg); }
    .scene.open .hearts .heart { opacity: 1; }
    .scene.open .letter {
      opacity: 1;
      transform: translate(-50%, -95px) rotateX(0deg) scale(1);
    }

    .scene.show-card .card {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(-50%) perspective(1200px) rotateY(0deg);
    }

    .scene.show-card .letter {
      opacity: 0;
      transform: translate(-50%, -36px) rotateX(-20deg) scale(0.96);
    }

    .scene.show-signature .signature {
      opacity: 1;
      animation: inkFlow 1.2s ease forwards;
    }

    .scene.closed .card,
    .scene.closed .letter {
      opacity: 0 !important;
      transform: translate(-50%, 95px) rotateX(82deg) scale(0.88) !important;
    }

    .scene.closed .seal { opacity: 1; transform: translate(-50%, -50%); animation: none; }

    @media (max-width: 520px) {
      .stage { transform: scale(.91); }
      .card { width: 308px; }
    }
  </style>
</head>
<body>
  <main class="scene" id="scene">
    <div class="hint" id="hint">Tap envelope</div>

    <div class="hearts" aria-hidden="true">
      <span class="heart">‚ù§</span><span class="heart">‚ù§</span><span class="heart">‚ù§</span>
      <span class="heart">‚ù§</span><span class="heart">‚ù§</span><span class="heart">‚ù§</span>
    </div>

    <div class="stage">
      <article class="card" id="card" aria-label="Valentine card">
        <h3>Happy Valentine's Day üíñ</h3>
        <p class="typed" id="typedMessage"></p>
        <p class="signature" id="signature">From Jerald</p>
        <div class="card-actions">
          <button id="closeBtn" type="button">Close</button>
        </div>
      </article>

      <section class="letter" id="letter" aria-label="Letter">
        <h2>To My Love,</h2>
        <p>
          Happy Valentine's Day. Thank you for the beautiful memories we've made this year ‚Äî from the loud laughs
          to the quiet, ordinary moments, like cooking together and appliance shopping as if we were an old couple
          whenever we were bored.
        </p>
        <p>
          Through every high and every challenge, my feelings for you have only grown stronger. You are my favourite
          person, and loving you keeps getting easier and deeper every day.
        </p>
        <p>Forever grateful for you. ‚ù§Ô∏è</p>
      </section>

      <div class="envelope-wrap" id="envelope" role="button" tabindex="0" aria-label="Open envelope">
        <div class="flap"></div>
        <div class="seal">‚ù§</div>
        <div class="envelope"></div>
      </div>
    </div>
  </main>

  <script>
    const scene = document.getElementById("scene");
    const envelope = document.getElementById("envelope");
    const typedMessage = document.getElementById("typedMessage");
    const hint = document.getElementById("hint");
    const closeBtn = document.getElementById("closeBtn");

    const message = "Thank you for every memory this year. Through every high and challenge, I only love you more. Forever grateful for you.";

    let isAnimating = false;
    let isOpen = false;

    const wait = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

    async function typeMessage() {
      typedMessage.classList.add("writing");
      typedMessage.textContent = "";
      for (let i = 0; i < message.length; i++) {
        typedMessage.textContent += message[i];
        await wait(30 + Math.random() * 20);
      }
      typedMessage.classList.remove("writing");
      scene.classList.add("show-signature");
    }

    function resetToClosedState() {
      isOpen = false;
      scene.classList.remove("crack", "open", "show-card", "show-signature");
      scene.classList.add("closed");
      typedMessage.textContent = "";
      hint.textContent = "Tap envelope";
    }

    async function openSequence() {
      if (isAnimating || isOpen) return;
      isAnimating = true;
      scene.classList.remove("closed");
      hint.textContent = "Unsealing your letter...";

      scene.classList.add("crack"); // wax seal cracking animation
      await wait(550);

      scene.classList.add("open"); // flap open + hearts + letter unfolding
      hint.textContent = "A letter for you...";

      await wait(980);
      scene.classList.add("show-card"); // card opens like a book

      await wait(860);
      await typeMessage(); // handwritten-like ink typing

      isOpen = true;
      isAnimating = false;
      hint.textContent = "Press Close to fold everything back";
    }

    envelope.addEventListener("click", openSequence);
    envelope.addEventListener("keydown", (event) => {
      if (event.key === "Enter" || event.key === " ") {
        event.preventDefault();
        openSequence();
      }
    });

    closeBtn.addEventListener("click", () => {
      if (isAnimating) return;
      resetToClosedState();
    });

    resetToClosedState();
  </script>
</body>
</html>
